<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="密码学笔记"><meta name="keywords" content="note"><meta name="author" content="Dai Sine"><meta name="copyright" content="Dai Sine"><title>密码学笔记 | Hi, Dai</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-117497526-4', 'auto');
ga('send', 'pageview');</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"WZKHQNIAUH","apiKey":"6e9d7c5fbc2b8a5e062f9a03039c5ce3","indexName":"daisine","hits":{"per_page":10},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-概述"><span class="toc-text">1. 概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-计算机安全概念"><span class="toc-text">1.1 计算机安全概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-OSI安全框架"><span class="toc-text">1.2 OSI安全框架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-安全攻击"><span class="toc-text">1.3 安全攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#四种类型"><span class="toc-text">四种类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#两种类型"><span class="toc-text">两种类型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-安全服务"><span class="toc-text">1.4 安全服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-安全机制-P14-表1-3"><span class="toc-text">1.5 安全机制 P14 表1.3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-网络安全模型"><span class="toc-text">1.6 网络安全模型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-传统加密技术"><span class="toc-text">2. 传统加密技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-密码学概念"><span class="toc-text">2.1 密码学概念</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#密码学"><span class="toc-text">密码学</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#基本概念"><span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#古典加密技术"><span class="toc-text">古典加密技术</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-密码学概述"><span class="toc-text">2.2 密码学概述</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#几个概念"><span class="toc-text">几个概念</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#分组密码与流密码"><span class="toc-text">分组密码与流密码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#密码破解-分析-P23"><span class="toc-text">密码破解/分析 P23</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#加密算法的安全"><span class="toc-text">加密算法的安全</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#隐写术-信息隐藏"><span class="toc-text">隐写术 / 信息隐藏</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-分组密码原理"><span class="toc-text">3. 分组密码原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-分组密码和数据加密标准-DES"><span class="toc-text">3.1 分组密码和数据加密标准(DES)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#乘积密码"><span class="toc-text">乘积密码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Feistel密码"><span class="toc-text">Feistel密码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#数据加密标准-DES"><span class="toc-text">数据加密标准 DES</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#多重DES"><span class="toc-text">多重DES</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-高级加密标准-AES"><span class="toc-text">3.2 高级加密标准 AES</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#数学基础：有限域算术"><span class="toc-text">数学基础：有限域算术</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#AES的评价标准"><span class="toc-text">AES的评价标准</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#AES算法加密过程"><span class="toc-text">AES算法加密过程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#AES算法解密过程"><span class="toc-text">AES算法解密过程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#AES密钥扩展"><span class="toc-text">AES密钥扩展</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#AES的实现"><span class="toc-text">AES的实现</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#AES的安全性"><span class="toc-text">AES的安全性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-分组密码的工作模式"><span class="toc-text">3.3 分组密码的工作模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#更先进的对称密码"><span class="toc-text">更先进的对称密码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#分组密码的操作模式"><span class="toc-text">分组密码的操作模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#电子密码本-ECB"><span class="toc-text">电子密码本 ECB</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#密码分组链接模式-CBC"><span class="toc-text">密码分组链接模式 CBC</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#密码反馈模式-CFB"><span class="toc-text">密码反馈模式 CFB</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#输出反馈模式-OFB"><span class="toc-text">输出反馈模式 OFB</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#计数器模式-CTR"><span class="toc-text">计数器模式 CTR</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-流密码"><span class="toc-text">4. 流密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-流密码概述"><span class="toc-text">4.1 流密码概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RC4算法"><span class="toc-text">RC4算法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#RC4概述"><span class="toc-text">RC4概述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RC4算法-1"><span class="toc-text">RC4算法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RC4-3bits"><span class="toc-text">RC4 3bits</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-密钥管理和分发"><span class="toc-text">5. 密钥管理和分发</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#密钥分发历史"><span class="toc-text">密钥分发历史</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#密钥分发模型-P319"><span class="toc-text">密钥分发模型 P319</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#密钥分发中心-KDC"><span class="toc-text">密钥分发中心 KDC</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#密钥分配方案"><span class="toc-text">密钥分配方案</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#层次密钥控制"><span class="toc-text">层次密钥控制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#会话密钥的生命周期"><span class="toc-text">会话密钥的生命周期</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#控制密钥的使用"><span class="toc-text">控制密钥的使用</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-密钥交换"><span class="toc-text">6. 密钥交换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-Diffie-Hellman-密钥交换"><span class="toc-text">6.1 Diffie-Hellman 密钥交换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-RSA算法"><span class="toc-text">6.2 RSA算法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#数论"><span class="toc-text">数论</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RSA算法描述"><span class="toc-text">RSA算法描述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RSA密钥产生"><span class="toc-text">RSA密钥产生</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RSA的安全性"><span class="toc-text">RSA的安全性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#公钥算法与对称加密"><span class="toc-text">公钥算法与对称加密</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-消息认证"><span class="toc-text">7. 消息认证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-安全服务"><span class="toc-text">7.1 安全服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-消息认证"><span class="toc-text">7.2 消息认证</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#消息认证"><span class="toc-text">消息认证</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#消息认证码"><span class="toc-text">消息认证码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hash函数-P239"><span class="toc-text">Hash函数 P239</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#安全Hash算法-SHA"><span class="toc-text">安全Hash算法 SHA</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#消息摘要"><span class="toc-text">消息摘要</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-数字签名"><span class="toc-text">8. 数字签名</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-数字签名简介"><span class="toc-text">8.1 数字签名简介</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#数字签名"><span class="toc-text">数字签名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#数字签名的特征"><span class="toc-text">数字签名的特征</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#数字签名需求"><span class="toc-text">数字签名需求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#数字签名过程-P300"><span class="toc-text">数字签名过程 P300</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#数字签名提供的安全服务"><span class="toc-text">数字签名提供的安全服务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-数字签名方案"><span class="toc-text">8.2 数字签名方案</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#RSA数字签名方案-P305"><span class="toc-text">RSA数字签名方案 P305</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-用户认证协议-P348"><span class="toc-text">8.3 用户认证协议 P348</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Kerberos"><span class="toc-text">Kerberos</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#X-509"><span class="toc-text">X.509</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-PGP-P445"><span class="toc-text">8.4 PGP P445</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PGP概述"><span class="toc-text">PGP概述</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-网络安全"><span class="toc-text">9. 网络安全</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-网络安全概述-P396"><span class="toc-text">9.1 网络安全概述 P396</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-SSL-TLS"><span class="toc-text">9.2 SSL / TLS</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SSL-TLS-P-397"><span class="toc-text">SSL / TLS P 397</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SSL-TLS提供服务："><span class="toc-text">SSL / TLS提供服务：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SSL-TLS-安全机制"><span class="toc-text">SSL/TLS 安全机制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SSL-TLS-结构"><span class="toc-text">SSL/TLS 结构</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-Wireshark-实验-TLS1-2"><span class="toc-text">9.3 Wireshark 实验 - TLS1.2</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Dai Sine</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">47</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">8</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">8</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2019/05/10/5cd525fea97ac.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Hi, Dai</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title">密码学笔记</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-12-01</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/软件工程/">软件工程</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="1-概述"><a href="#1-概述" class="headerlink" title="1. 概述"></a>1. 概述</h2><h3 id="1-1-计算机安全概念"><a href="#1-1-计算机安全概念" class="headerlink" title="1.1 计算机安全概念"></a>1.1 计算机安全概念</h3><p>网络和Internet安全领域涉及阻止、防止、检测和纠正信息传输中出现的安全违规欣慰的措施。<br><a id="more"></a></p>
<h3 id="1-2-OSI安全框架"><a href="#1-2-OSI安全框架" class="headerlink" title="1.2 OSI安全框架"></a>1.2 OSI安全框架</h3><ul>
<li>OSI安全框架主要关注：<ul>
<li>安全攻击：任何危机信息系统安全的行为。</li>
<li>安全机制：用来检测、阻止攻击或者从攻击状态恢复到正常状态的过程。</li>
<li>安全服务：加强数据处理系统和信息传输的安全性的一种处理过程或通信服务。</li>
</ul>
</li>
<li>安全在信息系统的范围很广<ul>
<li>信息安全</li>
<li>网络安全</li>
<li>计算机安全</li>
<li>数据库安全</li>
<li>软件安全  </li>
</ul>
</li>
</ul>
<h3 id="1-3-安全攻击"><a href="#1-3-安全攻击" class="headerlink" title="1.3 安全攻击"></a>1.3 安全攻击</h3><h5 id="四种类型"><a href="#四种类型" class="headerlink" title="四种类型"></a>四种类型</h5><ul>
<li><strong>阻断</strong>：使系统被破坏或者无法使用。<strong>对可用性的攻击</strong>。<ul>
<li>破环硬件</li>
<li>切断通信线路</li>
<li>禁用文件系统</li>
<li>DOS/DDOS (拒绝服务)</li>
</ul>
</li>
<li><strong>窃听</strong>：未经授权的一方访问信息。<strong>对保密性的攻击</strong>。<ul>
<li>窃听以捕获网络中的数据</li>
<li>非法复制文件/程序</li>
</ul>
</li>
<li><strong>修改</strong>：未经授权的一方不仅可以访问还可以修改信息。<strong>对完整性的攻击</strong>。<ul>
<li>更改文件中的数据</li>
<li>改变一个程序</li>
<li>修改消息的内容</li>
</ul>
</li>
<li><strong>伪装</strong>：未经授权的一方将假冒的对象插入到系统中。<strong>对真实性的攻击</strong>。<ul>
<li>在网络中插入虚假信息</li>
<li>将记录添加到文件中</li>
<li>改变程序</li>
</ul>
</li>
</ul>
<h5 id="两种类型"><a href="#两种类型" class="headerlink" title="两种类型"></a>两种类型</h5><ul>
<li><strong>主动攻击</strong>：对数据流进行修改或者伪造数据流。<strong>难以绝对地预防但容易检测。</strong><ul>
<li>伪装</li>
<li>重放</li>
<li>篡改</li>
<li>拒绝服务</li>
</ul>
</li>
<li><strong>被动攻击</strong>：对传输进行窃听和检测。<strong>难以检测但可以预防。
</strong> <ul>
<li>泄密</li>
<li>流量分析</li>
</ul>
</li>
</ul>
<h3 id="1-4-安全服务"><a href="#1-4-安全服务" class="headerlink" title="1.4 安全服务"></a>1.4 安全服务</h3><ul>
<li>保密性：确保隐私或者秘密信息不向非授权者泄露，也不被非授权者所使用。</li>
<li>真实性：信息和信息的来源是正确的，能够验证用户的身份。</li>
<li>完整性：防止信息被不恰当修改或破坏。</li>
<li>可用性：确保信息的及时和可靠的访问和使用。</li>
<li>防止抵赖：防止发送方或者接收方否认传输或者接受过某条消息。</li>
<li>可控性：限制和控制那些通过通信连接对主机和应用进行访问。(eg. 读写权限)</li>
</ul>
<h3 id="1-5-安全机制-P14-表1-3"><a href="#1-5-安全机制-P14-表1-3" class="headerlink" title="1.5 安全机制 P14 表1.3"></a>1.5 安全机制 P14 表1.3</h3><h3 id="1-6-网络安全模型"><a href="#1-6-网络安全模型" class="headerlink" title="1.6 网络安全模型"></a>1.6 网络安全模型</h3><p><img src="/Cryptography/网络安全模型.png" width="70%"></p>
<h2 id="2-传统加密技术"><a href="#2-传统加密技术" class="headerlink" title="2. 传统加密技术"></a>2. 传统加密技术</h2><h3 id="2-1-密码学概念"><a href="#2-1-密码学概念" class="headerlink" title="2.1 密码学概念"></a>2.1 密码学概念</h3><h5 id="密码学"><a href="#密码学" class="headerlink" title="密码学"></a>密码学</h5><ul>
<li>密码编码学</li>
<li>密码分析学</li>
</ul>
<h5 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h5><ul>
<li>明文 <code>P</code>：原始可理解的消息或数据，加密算法的输入。</li>
<li>加密算法 <code>E</code>：加密算法对明文进行各种代替和变换。</li>
<li>密钥 <code>K</code>：加密算法的输入。</li>
<li>密文 <code>C</code>：加密算法的输出。</li>
<li>解密算法 <code>D</code>： 本质上是加密算法的逆运算。输入密文和密钥，输出原始明文。</li>
</ul>
<h5 id="古典加密技术"><a href="#古典加密技术" class="headerlink" title="古典加密技术"></a>古典加密技术</h5><ul>
<li>置换：置换符号的位置。eg. SPARTAN SCYTALE(密码棒)<ul>
<li>棱柱侧面的数量{x}</li>
<li>算法：明文一维数组-&gt;多维数组-行列变换-&gt;密文一维数组密文</li>
<li>评价：统计</li>
</ul>
</li>
<li>替换：将明文字母替换成其他字母、数字或符号的方法。eg. Caesar密码<ul>
<li>移位的长度 {S}</li>
<li>字符编码后的加法运算</li>
<li>缺点：密钥长度太短 </li>
</ul>
</li>
<li>多表代替密码<ul>
<li>Auto-key Cipher<br><img src="/Cryptography/Auto-key.png" width="40%"></li>
<li>Playfair密码：密文仍然完好地保留了明文语言的大部分结构特征。<br><img src="/Cryptography/Playfair.png" width="40%"></li>
<li>Vigenère密码：破译能否取得进展取决于能否判定密钥词的长度。<br><img src="/Cryptography/Vig.png" width="40%"></li>
<li>Hill密码：基于线性代数 P30。优点是完全隐藏了单字母频率特性。</li>
</ul>
</li>
</ul>
<h3 id="2-2-密码学概述"><a href="#2-2-密码学概述" class="headerlink" title="2.2 密码学概述"></a>2.2 密码学概述</h3><h5 id="几个概念"><a href="#几个概念" class="headerlink" title="几个概念"></a>几个概念</h5><ul>
<li>Kerckhoff准则：密码系统的安全性不在于算法的保密，而在于当对手获知了算法和密文后分析出密钥或明文的难度。</li>
<li>混淆：尽可能使密文和加密密钥间的统计关系更加复杂，以阻止攻击者发现密钥。</li>
<li>扩散：明文的统计特征消散在密文中。</li>
<li>雪崩效应：明文或密钥的某一位发生变化会导致密文的很多位发生变化。</li>
</ul>
<h5 id="分组密码与流密码"><a href="#分组密码与流密码" class="headerlink" title="分组密码与流密码"></a>分组密码与流密码</h5><ul>
<li>分组密码：将明文分组作为整体加密并且通常得到的是与明文等长的密文分组。</li>
<li>流密码：每次加密数据流的一位或者一个字节。</li>
</ul>
<h5 id="密码破解-分析-P23"><a href="#密码破解-分析-P23" class="headerlink" title="密码破解/分析 P23"></a>密码破解/分析 P23</h5><ul>
<li>唯密文攻击<ul>
<li>最容易防范的，攻击者拥有的信息量较少。</li>
<li>需要获取更多密文进行分析</li>
</ul>
</li>
<li>已知部分明文攻击<ul>
<li>可能词攻击</li>
</ul>
</li>
<li>选择明文攻击<ul>
<li>分析者通过某种方式获取信源系统，让发送方在发送的信息中插入一段由他选择的信息。</li>
</ul>
</li>
<li>选择密文攻击</li>
<li>选择文本攻击</li>
<li>蛮力攻击：在一个密文中尝试每个可能的密钥直到获得翻译成可理解的明文。一般需要尝试所有可能密钥的一半。</li>
</ul>
<h5 id="加密算法的安全"><a href="#加密算法的安全" class="headerlink" title="加密算法的安全"></a>加密算法的安全</h5><ul>
<li>无条件安全：无论有多少可使用的密文，都不足以唯一确定密文所对应的明文。</li>
<li>计算上安全：加密体制满足下面两条中任意一条：<ul>
<li>破译密码的代价超出密文信息的价值。</li>
<li>破译密码的时间超出密文信息的有效生命期。</li>
</ul>
</li>
<li>可证明安全：破译密码的难度与数学上某个困难问题的难度相同。</li>
<li>实际安全：包括可证明安全和计算安全</li>
</ul>
<h5 id="隐写术-信息隐藏"><a href="#隐写术-信息隐藏" class="headerlink" title="隐写术 / 信息隐藏"></a>隐写术 / 信息隐藏</h5><ul>
<li>隐写术：隐藏信息的存在。</li>
<li>密码学：通过对文本信息的不同转换而实现信息的对外不可读。</li>
</ul>
<h2 id="3-分组密码原理"><a href="#3-分组密码原理" class="headerlink" title="3. 分组密码原理"></a>3. 分组密码原理</h2><h3 id="3-1-分组密码和数据加密标准-DES"><a href="#3-1-分组密码和数据加密标准-DES" class="headerlink" title="3.1 分组密码和数据加密标准(DES)"></a>3.1 分组密码和数据加密标准(DES)</h3><h5 id="乘积密码"><a href="#乘积密码" class="headerlink" title="乘积密码"></a>乘积密码</h5><ul>
<li>P-box(置换)<ul>
<li>直接的P-box是可逆的，压缩和扩张的P-box不可逆。<br><img src="/Cryptography/pbox.png" width="40%"></li>
</ul>
</li>
<li>S-bos(替换)<ul>
<li>m x n的替换单元，m与n不一定相同。<br><img src="/Cryptography/sbox.png" width="40%"></li>
</ul>
</li>
<li>XOR<ul>
<li>相同为0不同为1</li>
<li>A XOR B XOR B = A </li>
</ul>
</li>
<li>循环移位<ul>
<li><img src="/Cryptography/循环移位.png" width="40%"></li>
</ul>
</li>
<li>交换<ul>
<li>是循环位移的一个特例，k = N / 2</li>
</ul>
</li>
<li><p>分离/合并 </p>
<p><img src="/Cryptography/乘积密码.png" width="40%"></p>
</li>
</ul>
<h5 id="Feistel密码"><a href="#Feistel密码" class="headerlink" title="Feistel密码"></a>Feistel密码</h5><ul>
<li>Feistel密码是对称加密算法在块加密结构中使用的一种密码结构。</li>
<li>基于可逆的乘积密码。Feistel密码解密是加密的逆过程。</li>
<li>实现了Shannon的S-P net 概念。</li>
<li><p>Feistel密码的属性：</p>
<ul>
<li>分组长度 </li>
<li>密钥长度</li>
<li>迭代轮数：多轮加密可以取得很高的安全性。</li>
<li>子密钥生成算法</li>
<li>轮函数F：提供“混乱”，非线性，雪崩效应</li>
<li>快速软件加 / 解密</li>
<li>简化分析难度</li>
</ul>
<p><img src="/Cryptography/Feistel密码.png" width="50%"></p>
</li>
</ul>
<h5 id="数据加密标准-DES"><a href="#数据加密标准-DES" class="headerlink" title="数据加密标准 DES"></a>数据加密标准 DES</h5><ul>
<li>DES加密过程：是由2个P-box 初始置换和最终置换、16轮Feistel加密组成。即，除了初始和末尾的置换，DES的结构与Feistel密码结构完全相同。<br><img src="/Cryptography/DES.png" width="40%"><ul>
<li>初始置换和末尾置换是互逆的</li>
<li>DES的核心是DES函数，他将一个48位的轮密钥加到32位的左半/右半部分并得到32位的输出。扩展后的右部分和轮密钥都是48位长度，且轮密钥仅在该轮使用。<br><img src="/Cryptography/DESF.png" width="30%"></li>
<li>DES使用了8个P-box来扩展，每个P-box有4位的输入和6位的输出</li>
<li>S-box做了真正的混淆。DES使用了8个S-box，且每个都有6位的输入和4位的输出<br><img src="/Cryptography/DESSbox.png" width="50%">  <img src="/Cryptography/DESSbox3.png" width="30%"><br><img src="/Cryptography/DESSbox2.png" width="50%"></li>
</ul>
</li>
<li>DES解密过程<ul>
<li>与加密过程算法相同</li>
<li>使用k<sub>1</sub> -&gt; k<sub>16</sub>加密</li>
<li>使用k<sub>16</sub> -&gt; k<sub>1</sub>解密</li>
</ul>
</li>
<li>DES密钥的生成和扩展<ul>
<li>64位随机数，丢弃8位重新排列成56位</li>
<li>轮密钥生成器在56位密钥中生成一个48位的轮密钥<br><img src="/Cryptography/DES密钥.png" width="40%"></li>
<li>16个子密钥由56位密钥分裂成两半，左右两部分各占一半，然后压缩置换他们，为48位的轮密钥。</li>
</ul>
</li>
<li>DES的弱点：<ul>
<li>P-box的弱点</li>
<li>S-box的弱点</li>
<li>密钥的弱点：56位密钥有 256 = 7.2×1016，随着计算机的发展，蛮力破解能越来越快地破解DES的密文。</li>
</ul>
</li>
<li>DES的密码分析<ul>
<li>微分密码分析</li>
<li>线性密码分析</li>
<li>相关密钥攻击</li>
</ul>
</li>
</ul>
<h5 id="多重DES"><a href="#多重DES" class="headerlink" title="多重DES"></a>多重DES</h5><ul>
<li>双重DES：2个密钥k<sub>1</sub>，k<sub>2</sub> <ul>
<li>C = E<sub>k<sub>1</sub></sub>(D<sub>k<sub>2</sub></sub>(E<sub>k<sub>1</sub></sub>(P)))</li>
<li>P = D<sub>k<sub>1</sub></sub>(E<sub>k<sub>2</sub></sub>(D<sub>k<sub>1</sub></sub>(C)))</li>
</ul>
</li>
<li>三重DES：3个密钥k<sub>1</sub>，k<sub>2</sub>，k<sub>3</sub><ul>
<li>C = E<sub>k<sub>3</sub></sub>(D<sub>k<sub>2</sub></sub>(E<sub>k<sub>1</sub></sub>(P)))</li>
<li>P = D<sub>k<sub>1</sub></sub>(P<sub>k<sub>2</sub></sub>(D<sub>k<sub>3</sub></sub>(P)))</li>
</ul>
</li>
<li>比DES更安全，但成本更高。</li>
</ul>
<h3 id="3-2-高级加密标准-AES"><a href="#3-2-高级加密标准-AES" class="headerlink" title="3.2 高级加密标准 AES"></a>3.2 高级加密标准 AES</h3><h5 id="数学基础：有限域算术"><a href="#数学基础：有限域算术" class="headerlink" title="数学基础：有限域算术"></a>数学基础：有限域算术</h5><ul>
<li>有限域：Galois域GF(2<sup>8</sup>)</li>
<li>任何一个字节f(x)可以表示为多项式：f(x) = b<sub>7</sub>x<sup>7</sup> + b<sub>6</sub>x<sup>6</sup> + b<sub>5</sub>x<sup>5</sup> + b<sub>4</sub>x<sup>4</sup> + b<sub>3</sub>x<sup>3</sup>+b<sub>2</sub>x<sup>2</sup> + b<sub>1</sub>x + b<sub>0</sub></li>
<li>1100101 —&gt; x<sup>7</sup> + x<sup>6</sup> +x<sup>3</sup> + 1 <ul>
<li>eg. 91<sub>hex</sub> = (1001  0001)<sub>bin</sub> = x<sup>7</sup> + x<sup>4&lt;/sup + 1 </sup></li>
</ul>
</li>
<li>加法运算：：a⊕b（XOR）<ul>
<li>封闭性：a∈F，b∈F =&gt; a⊕b∈F </li>
<li>交换律：a⊕b=b⊕a</li>
<li>结合律：a⊕（b⊕c）=（a⊕b）⊕c</li>
<li>单位元：0，使得a⊕0 = a</li>
<li>加法逆元：a⊕（-a）= 0（a = -a）</li>
</ul>
</li>
<li>乘法运算：a=f(x), b=g(x), m=m(x), a⊙b=f(x)×g(x) mod m(x)<ul>
<li>封闭性：a∈F, b∈F  =&gt; a⊙b∈F </li>
<li>交换律：a⊙b= b⊙a</li>
<li>结合律：a⊙(b⊙c)= (a⊙b)⊙c</li>
<li>分配率：a⊙(b⊕c)= (a⊙b)⊕(a⊙c)</li>
<li>单位元：1 =&gt; a ⊙1=a</li>
<li>乘法逆元：a⊙a-1= 1 mod m</li>
</ul>
</li>
<li>GF(2<sup>8</sup>)模乘法运算；m(x) = x<sup>8</sup> + x<sup>4</sup> + x<sup>3</sup> + x + 1<ul>
<li>{01} ⊙ { b<sub>7</sub>b<sub>6</sub>b<sub>5</sub>b<sub>4</sub>b<sub>3</sub>b<sub>2</sub>b<sub>1</sub>b<sub>0</sub> } = { b<sub>7</sub>b<sub>6</sub>b<sub>5</sub>b<sub>4</sub>b<sub>3</sub>b<sub>2</sub>b<sub>1</sub>b<sub>0</sub> }   <strong>被乘数不发生变化</strong></li>
<li>{02} ⊙ { b<sub>7</sub>b<sub>6</sub>b<sub>5</sub>b<sub>4</sub>b<sub>3</sub>b<sub>2</sub>b<sub>1</sub>b<sub>0</sub> } = { b<sub>6</sub>b<sub>5</sub>b<sub>4</sub>b<sub>3</sub>b<sub>2</sub>b<sub>1</sub>b<sub>0</sub> } <strong>b7 = 0 的情况</strong></li>
<li>{02} ⊙ { b<sub>7</sub>b<sub>6</sub>b<sub>5</sub>b<sub>4</sub>b<sub>3</sub>b<sub>2</sub>b<sub>1</sub>b<sub>0</sub> } ={ b<sub>6</sub>b<sub>5</sub>b<sub>4</sub>b<sub>3</sub>b<sub>2</sub>b<sub>1</sub>b<sub>0</sub> } ⊕ (00011011) <strong>b7 = 1 的情况</strong></li>
<li>{03} ⊙ {xx } ={xx} ⊕( {02} ⊙ {xx} )</li>
</ul>
</li>
<li>GF(2<sup>8</sup>)模乘法运算 eg. <ul>
<li>{02} ⊙ {2B} = {02} ⊙ { 0010 1011} = { 0101 0110}</li>
<li>{02} ⊙ {91}  = {02} ⊙ {1001 0001}  = {0010 0010} ⊕ {00011011}  = 00111001</li>
<li>{03} ⊙ {6E} = {6E} ⊕( {02}⊙{6E} ) = {0110 1110} ⊕ {10111100} = 10110010</li>
</ul>
</li>
</ul>
<h5 id="AES的评价标准"><a href="#AES的评价标准" class="headerlink" title="AES的评价标准"></a>AES的评价标准</h5><ul>
<li>NIST于1997年发出了AES的请求，NIST定义的选择AES的标准氛围三个方面：安全、成本、实施。</li>
<li>1998年6月接受了15名候选人。</li>
<li>1999年5个被选入名单：<ul>
<li>MARS􏰥IBM􏰦(IBM):􏱪􏲨 扩展Feistel密码， 􏰁􏰂􏰏128位分组，􏱉􏰚􏰷􏰏128-1248位密钥。复杂、快速，安全系数高。</li>
<li>RC6􏰥(USA)：􏰦􏱠128位分组，􏱉􏰚􏰷􏰏128-256位密钥。非常简单、快速，安全系数低。 􏱉􏰁􏰝􏰢􏳹􏰶􏲻􏲇􏰏􏳹􏰶􏳶􏰢􏰆􏰇􏰃􏰻􏳺􏰢 􏱉􏰁􏰝􏰢􏱨􏱩􏲕􏳶􏳷􏰢􏰆􏰇􏰃􏰻􏳸􏰢 􏱉􏰁􏰝􏰢􏱨􏱩􏲕􏳶􏳷􏰢􏰆􏰇􏰃􏰻􏳸􏰢</li>
<li>Rijndael􏰥(Belgium􏰦)：􏱠128位分组，􏱉􏰚􏰷􏰏128 - 256位密钥。干净、快，安全系数良好。</li>
<li>Serpent􏰥(Euro)：复杂、干净，安全系数非常高。</li>
<li>Twofish(􏰥USA􏰦􏱠􏱨􏱩􏲕􏳹􏰶􏳶􏰢􏰆􏰇􏰃􏰻􏳸􏰦􏱠􏳽􏲕􏳻􏳼􏰢􏰆􏰇􏰃􏰻􏳹􏰶􏳸􏰢)：复杂、非常快，安全系数高。</li>
</ul>
</li>
</ul>
<h5 id="AES算法加密过程"><a href="#AES算法加密过程" class="headerlink" title="AES算法加密过程"></a>AES算法加密过程</h5><ul>
<li>明文分组长度：128位 / 16字节</li>
<li>密钥长度：16字节(128位)，24字节(192位)或32字节(256位)。  </li>
<li>轮数：10 / 12 / 14</li>
<li>轮密钥长度：128位<ul>
<li>在<strong>第一轮开始前添加轮密钥</strong></li>
<li>在<strong>最后一回合没有列混淆</strong><br><img src="/Cryptography/AES.png" width="48%"><img src="/Cryptography/AES2.png" width="52%"><img src="/Cryptography/AES4.png" width="30%"></li>
</ul>
</li>
<li>加密和解密算法的输入是一个128位分组，这个分组被描述为4 * 4 的字节方阵。这个分组被复制到<strong>状态数组</strong>，并在加密或解密的各个阶段被修改。</li>
<li>四个不同的阶段<ul>
<li>字节替换：加密S盒，解密S盒<sup>-1</sup>，S盒必须是可逆的。S盒不是自逆的。   <strong>P103 S盒的构造</strong><br><img src="/Cryptography/AESS.png" width="30%"></li>
<li>行移位(<strong>以字节为单位</strong>)：第1行：不移，第2行：左移1字节，第3行，左移2字节，第4行：左移3字节。</li>
<li>列混淆：<br><img src="/Cryptography/AESC.png" width="40%"><img src="/Cryptography/AESC2.png" width="50%"></li>
<li>轮密钥加：加密过程中，每轮的输入与轮密钥异或一次（当前分组和扩展密钥的一部分进行按位异或）；因为二进制数连续异或一个数结果是不变的，所以在解密时再异或上该轮的密钥即可恢复输入。 轮密钥加是自逆的</li>
</ul>
</li>
</ul>
<h5 id="AES算法解密过程"><a href="#AES算法解密过程" class="headerlink" title="AES算法解密过程"></a>AES算法解密过程</h5><ul>
<li>是加密过程的逆。</li>
<li>字节变换：加密S盒，解密S盒<sup>-1</sup></li>
<li>列混淆：矩阵C进行加密，矩阵C<sup>-1</sup>解密。</li>
<li>反向轮密钥。</li>
</ul>
<h5 id="AES密钥扩展"><a href="#AES密钥扩展" class="headerlink" title="AES密钥扩展"></a>AES密钥扩展</h5><ul>
<li>AES使用密码扩展算法创建每一轮的轮密钥。如果轮数为Nr，密钥扩展算法会为一个128位(= 16个字节 = 4个字)的加密密钥输出 Nr+1 个轮密钥。</li>
<li>AES密钥扩展算法的输入值是4个字(16字节)，输出是44个字组成的一维线性数组。<br><img src="/Cryptography/AESkey.png" width="50%"></li>
</ul>
<h5 id="AES的实现"><a href="#AES的实现" class="headerlink" title="AES的实现"></a>AES的实现</h5><ul>
<li>AES可以在软件，硬件和固件中实现。 实现可以使用表查找过程或使用明确定义的代数结构的例程。</li>
<li>AES中使用的算法非常简单，可以使用廉价的处理器和最少的内存来轻松实现。</li>
</ul>
<h5 id="AES的安全性"><a href="#AES的安全性" class="headerlink" title="AES的安全性"></a>AES的安全性</h5><ul>
<li>AES是在DES之后设计的。 大多数针对DES的已知攻击已经在AES上进行了测试。</li>
<li>蛮力攻击：由于密钥较大，AES肯定比DES更安全。</li>
<li>统计攻击：许多测试未能成功对密文进行统计分析。</li>
<li>差分和线性攻击：目前还没有对AES的差异和线性攻击。</li>
</ul>
<h3 id="3-3-分组密码的工作模式"><a href="#3-3-分组密码的工作模式" class="headerlink" title="3.3 分组密码的工作模式"></a>3.3 分组密码的工作模式</h3><h5 id="更先进的对称密码"><a href="#更先进的对称密码" class="headerlink" title="更先进的对称密码"></a>更先进的对称密码</h5><ul>
<li>IDEA: International Data Encryption Algorithm<ul>
<li>1992, Lai Xuejia (来学嘉)</li>
<li>64位分组大小，128位密钥, 8轮<br><img src="/Cryptography/IDEA.png" width="50%"></li>
</ul>
</li>
<li>Blowfish<ul>
<li>Bruce Schneier, 1993 </li>
<li>Feistel密码结构</li>
<li>64位分组大小，32–448位密钥, 16轮</li>
<li>继承者: Twofish</li>
<li>Key Generator</li>
<li>complex<br><img src="/Cryptography/Blowfish.png" width="50%"></li>
</ul>
</li>
<li>RC5<ul>
<li>可变分组大小（32,64或128位），可变密钥大小（0到2040位）和可变轮次数（0到255）。 </li>
<li>最初建议的参数选择是块大小为64位，128位密钥和12轮。</li>
<li>继承者：RC6<br><img src="/Cryptography/RC5.png" width="15%"></li>
</ul>
</li>
<li>高级分组密码的特点<ul>
<li>可变性：密钥长度，分组大小，轮数，S盒，圆函数</li>
<li>复杂的轮函数生成</li>
<li>执行密钥的更多角色：S盒，圆形移位</li>
</ul>
</li>
</ul>
<h5 id="分组密码的操作模式"><a href="#分组密码的操作模式" class="headerlink" title="分组密码的操作模式"></a>分组密码的操作模式</h5><ul>
<li>对称加密模式可以使用现代分组密码完成。</li>
<li>操作模式已经被设计以使用DES或AES加密任何大小的文本。</li>
<li>实质上，工作模式是一项增强密码算法或者使算法适应具体应用的技术。</li>
</ul>
<h5 id="电子密码本-ECB"><a href="#电子密码本-ECB" class="headerlink" title="电子密码本 ECB"></a>电子密码本 ECB</h5><ul>
<li>一次处理一组明文分块，每次使用相同的密钥加密。<br><img src="/Cryptography/ECB.png" width="55%"></li>
<li>ECB评价<ul>
<li>消息中若有几个相同的明文组，那么密文也将出现几个相同的密文分组。</li>
<li>􏲒􏰍􏳿􏴀􏱺􏱮􏳾􏰅􏴁􏱅􏴂􏴃􏲒􏰍􏳿􏴀􏱺􏱮􏳾􏰅􏴁􏱅􏴂􏴃无法阻止长消息的修改攻击，</li>
<li>无错误传播：传输中的单个错误可能会在相应块的多个位中产生错误。但该错误对于其他块没有任何影响。（why：因为ECB一次处理一个明文分块，每个明文块使用相同的密钥独立编码。）</li>
</ul>
</li>
<li>ECB适用于：<ul>
<li>单个数据的安全传输</li>
<li>eg. 加密 密钥，口令 </li>
</ul>
</li>
</ul>
<h5 id="密码分组链接模式-CBC"><a href="#密码分组链接模式-CBC" class="headerlink" title="密码分组链接模式 CBC"></a>密码分组链接模式 CBC</h5><ul>
<li>为了克服ECB的弱点，我们需要将重复的明文文组加密成不同的密文分组。</li>
<li>CBC的输入是当前明文组的上一个密文组的异或，使用的密钥是相同的。  </li>
<li>IV 初始向量：为了产生密文的第一个密文块，初始向量IV与第一个明文块进行异或。</li>
<li>IV必须为收发双方共享，但第三方不能预测。为了最大限度的安全。IV不能不经授权而修改。<br><img src="/Cryptography/CBC.png" width="55%"></li>
<li>CBC的加密和解密是互逆的。</li>
<li>CBC方式要求如果最后的分组不是完整的分组，则需要填充至b位的满分组。<ul>
<li>P<sub>i</sub> = D<sub>K</sub>(C<sub>i</sub>)⊕C<sub>i-1</sub>= D<sub>K</sub>(E<sub>K</sub>(P<sub>i</sub>⊕C<sub>i-1</sub>))⊕C<sub>i-1</sub> = P<sub>i</sub>⊕C<sub>i-1</sub>⊕C<sub>i-1</sub></li>
</ul>
</li>
<li>CBC适用于：<ul>
<li>面向分组的通用传输</li>
<li>消息鉴别 / 认证</li>
</ul>
</li>
</ul>
<h5 id="密码反馈模式-CFB"><a href="#密码反馈模式-CFB" class="headerlink" title="密码反馈模式 CFB"></a>密码反馈模式 CFB</h5><ul>
<li>实时地传输长消息。</li>
<li>解密与加密使用相同的办法，只有一点不同：将收到的密文单元与加密函数的输出异或得到明文单元。这里使用的是加密函数而非解密函数。 </li>
<li>与明文异或的位流是<strong>与明文相关的</strong>。<br><img src="/Cryptography/CFB.png" width="50%">  <img src="/Cryptography/CFB2.png" width="50%"></li>
<li>CFB：错误传播<ul>
<li>消息认证</li>
<li>在<strong>可靠的信道</strong></li>
</ul>
</li>
<li>CFB适用于：<ul>
<li>面向<strong>数据流</strong>的通用传输  </li>
<li>认证 </li>
</ul>
</li>
</ul>
<h5 id="输出反馈模式-OFB"><a href="#输出反馈模式-OFB" class="headerlink" title="输出反馈模式 OFB"></a>输出反馈模式 OFB</h5><ul>
<li>没有错误传播：传输过程中某位上发生的错误不会影响其他位。OFB作为流密码，可以在<strong>不可靠信道</strong>使用。</li>
<li>不需要将明文填充到长度是分组长度的整数倍。</li>
<li>缺点：抗消息流篡改攻击能力不如CFB<br><img src="/Cryptography/OFB.png" width="50%">  <img src="/Cryptography/OFB2.png" width="50%"></li>
<li>OFB适用于<ul>
<li>噪声信道上<strong>的数据流传输</strong>，瑞卫星通信</li>
</ul>
</li>
</ul>
<h5 id="计数器模式-CTR"><a href="#计数器模式-CTR" class="headerlink" title="计数器模式 CTR"></a>计数器模式 CTR</h5><ul>
<li>没有反馈。</li>
<li>密钥流的伪随机用计数器来实现。<br><img src="/Cryptography/CTR.png" width="50%">  <img src="/Cryptography/CTR2.png" width="50%"></li>
<li>CTR适用于<ul>
<li>面向分组的通用传输，属于数据流的传输</li>
<li>用于高速需求</li>
</ul>
</li>
</ul>
<h2 id="4-流密码"><a href="#4-流密码" class="headerlink" title="4. 流密码"></a>4. 流密码</h2><h3 id="4-1-流密码概述"><a href="#4-1-流密码概述" class="headerlink" title="4.1 流密码概述"></a>4.1 流密码概述</h3><ul>
<li>一个典型的流密码每次加密一个字节的明文，产生伪随机密钥流，与明文流的每个字节进行按位异或运算，得到一个密文字节。</li>
<li>“一次一密”使用的是真正的随机数流，而流密码使用的是伪随机数流。</li>
<li>流密码的随机性完全破坏了消息中的统计的性质。</li>
<li>不能重复使用流密码，否则能够恢复消息。而分组密码可以重复使用密钥。<br><img src="/Cryptography/stream.png" width="60%"></li>
<li>一些需要考虑的方面：<ul>
<li>长时间没有重复</li>
<li>统计学上随机</li>
<li>取决于足够大的密钥的线形复杂性</li>
<li>正确设计，可以像具有相同大小密钥的分组密码一样安全，但通常更简单、快速。</li>
</ul>
</li>
<li>流密码：使用分组密码模式——OFB</li>
</ul>
<h3 id="RC4算法"><a href="#RC4算法" class="headerlink" title="RC4算法"></a>RC4算法</h3><h5 id="RC4概述"><a href="#RC4概述" class="headerlink" title="RC4概述"></a>RC4概述</h5><ul>
<li>RC4是流密码，RC5是分组加密算法</li>
<li>RC4是一个面向字节的流密码，其中明文的一个字节与一个密钥字节进行X-存储，以产生一个密文字节。</li>
<li>RSA DSI的私有的密码</li>
<li>另一个是Ron Rivest设计于1987年，简单、有效：<ul>
<li>可变长度的密钥，面向字节的流密码</li>
<li>广泛使用（网络SSL / TLS，无线WEP）</li>
<li>密钥形成所有8位数的随机排列，使用该排列来搅乱一次处理一个字节的输入信息</li>
</ul>
</li>
</ul>
<h5 id="RC4算法-1"><a href="#RC4算法-1" class="headerlink" title="RC4算法"></a>RC4算法</h5><ul>
<li>基本描述<ul>
<li>可变长度密钥K：1-256个字节(8-2048位)。密钥K的长度keylen与明文长度、密钥流长度无关，通常取16字节(128bits)</li>
<li>状态向量S：256个字节，S的元素记为S[0], S[1], … , S[256]。<strong>从始至终置换后的S包含从0-255的8位数，只不过位置发生了变化</strong></li>
<li>临时向量T：256个字节，每个单元也是一个字节。如果密钥K的长度是256字节，则直接把密钥的值赋给T，否则轮转地将密钥的每个字节赋给T。</li>
<li>密钥流：密钥流的长度和明文的长度是对应的(相等)<br><img src="/Cryptography/RC4.png" width="60%"></li>
</ul>
</li>
<li>RC4算法具体描述：<ul>
<li>初始化S和T</li>
<li>S的初始置换</li>
<li>密钥流的生成</li>
<li><strong>加密</strong>时将k的值与明文的下一字节<strong>异或</strong>；<strong>解密</strong>时将k的值与密文的下一个字节<strong>异或</strong>。</li>
</ul>
</li>
<li>RC4的安全性<ul>
<li>声称可以抵御已知攻击</li>
<li>有一些分析，没有实际意义</li>
<li>结果是非线性</li>
<li>由于RC4是流密码，因此不能用重复的密钥</li>
<li>关注WEP，但由于是密钥处理而不是RC4本身</li>
</ul>
</li>
</ul>
<h5 id="RC4-3bits"><a href="#RC4-3bits" class="headerlink" title="RC4 3bits"></a>RC4 3bits</h5><ul>
<li>是RC4算法的一个变体。</li>
<li>可变长度的密钥：3位 - 24位</li>
<li>24位的状态向量<strong>S</strong>的元素：S[0], S[1], … , S[8]</li>
<li>eg.<ul>
<li>明文：(7 2 5 1 5)<sub>oct</sub>     = {111 010 101 001 101}<sub>bin</sub></li>
<li>密钥：(7 4 3 2)<sub>oct</sub> = {111 100 011 010}<sub>bin</sub>   (密钥长度 = 4*3bit=12) </li>
<li>初始化：<br><img src="/Cryptography/初始化.png" width="60%"></li>
<li>初始置换：<br><img src="/Cryptography/初始置换.png" width="60%"><br><img src="/Cryptography/初始置换2.png" width="60%"></li>
<li>密钥流的生成：<br><img src="/Cryptography/流密钥1.png" width="60%"><br><img src="/Cryptography/流密钥2.png" width="60%"></li>
</ul>
</li>
</ul>
<h2 id="5-密钥管理和分发"><a href="#5-密钥管理和分发" class="headerlink" title="5. 密钥管理和分发"></a>5. 密钥管理和分发</h2><h5 id="密钥分发历史"><a href="#密钥分发历史" class="headerlink" title="密钥分发历史"></a>密钥分发历史</h5><ul>
<li>在第二次世界大战期间，德国高级司令部不得不将其每月的日记账分发给其所有谜运营商。而且，U型船往往需要长时间远离开基地，不得不以某种方式获得定期供应的钥匙。</li>
<li>美国政府的密钥由COMSEC管理和分发。在20世纪70年代，COMSEC负责每天运输大量的钥匙。当携带COMSEC材料的船舶进入码头时，密码管理机构将在船上行进，收集成堆的卡片，纸带，软盘，然后将它们交付给目标收件人。</li>
</ul>
<h5 id="密钥分发模型-P319"><a href="#密钥分发模型-P319" class="headerlink" title="密钥分发模型 P319"></a>密钥分发模型 P319</h5><ol>
<li>A选择一个密钥后以物理的方式(安全)传递给B。</li>
<li>第三方选择密钥后物理地传递给A和B。</li>
<li>如果A和B先前或者最近使用过一个密钥，则一方可以将新密钥用旧密钥加密后发送给另一方。</li>
<li>如果A和B到第三方C有加密连接，C可以在加密连接上传送密钥给A和B。</li>
<li>第三方加密：<strong>密钥分发中心(KDC)</strong>负责根据用户的需要来分发密钥。</li>
</ol>
<h5 id="密钥分发中心-KDC"><a href="#密钥分发中心-KDC" class="headerlink" title="密钥分发中心 KDC"></a>密钥分发中心 KDC</h5><ul>
<li>密钥分发中心是基于密钥层次体系的，最少需要两个密钥层。<ul>
<li>会话密钥：用于持续时间的逻辑连接，如帧的转发或传输连接，然后随着连接的断开而丢弃。</li>
<li>主密钥：用户和KDC共享的唯一的主密钥。用于会话密钥的加密分发。</li>
<li>主密钥的分发可以通过一些不加密的方式完成，如物理传递</li>
</ul>
</li>
<li>评价：<ul>
<li>在两个人可以交换秘密之前，他们必须已经分享了一个秘密。</li>
<li>大量的会话密钥通过互联网进行分发。</li>
</ul>
</li>
</ul>
<h5 id="密钥分配方案"><a href="#密钥分配方案" class="headerlink" title="密钥分配方案"></a>密钥分配方案</h5><ul>
<li>Needham/Schreoder 认证协议：KDC <strong>P321</strong><br><img src="/Cryptography/KDC.png" width="55%"></li>
<li>Denning认证协议 : timestamps<br><img src="/Cryptography/timestamps.png" width="55%"></li>
<li>Neuman协议：<br><img src="/Cryptography/Neuman.png" width="55%"></li>
</ul>
<h5 id="层次密钥控制"><a href="#层次密钥控制" class="headerlink" title="层次密钥控制"></a>层次密钥控制</h5><ul>
<li>对于大型网络，需要建立KDC的层次体系。<ul>
<li>同一个本地域的各个实体相互通信，由本地KDC负责密钥分发。</li>
<li>两个实体在不同域，由两个相对应的本地KDC通过全局KDC协商产生共享密钥。</li>
</ul>
</li>
<li>层次策略使得主密钥分发的开销最小化。</li>
</ul>
<h5 id="会话密钥的生命周期"><a href="#会话密钥的生命周期" class="headerlink" title="会话密钥的生命周期"></a>会话密钥的生命周期</h5><ul>
<li>会话密钥交换得越频繁就越安全。密钥分发会延迟交换的开始时间，增加网络负担。</li>
<li>对于<strong>面向连接的协议</strong>，在会话的整个生命周期中使用同一个会话密钥。</li>
<li>对于<strong>无连接的协议</strong>，没有明确的连接初始和终止。最安全的方法是每次都使用新的会话密钥，但开销变大。</li>
</ul>
<h5 id="控制密钥的使用"><a href="#控制密钥的使用" class="headerlink" title="控制密钥的使用"></a>控制密钥的使用</h5><ul>
<li>数据加密密钥，用于网络中通用通信</li>
<li>PIN加密密钥，用于电子资金过户的销售点应用的个人识别码(PIN)</li>
<li>文件加密密钥：用于存储可公开访问的加密文件。</li>
</ul>
<h2 id="6-密钥交换"><a href="#6-密钥交换" class="headerlink" title="6. 密钥交换"></a>6. 密钥交换</h2><h3 id="6-1-Diffie-Hellman-密钥交换"><a href="#6-1-Diffie-Hellman-密钥交换" class="headerlink" title="6.1 Diffie-Hellman 密钥交换"></a>6.1 Diffie-Hellman 密钥交换</h3><ul>
<li>加密和解密的密钥不同。(私钥和公钥)</li>
<li>相比对称加密的密钥分发，不用等待获取会话密钥，然后才能加密和发送消息。</li>
<li>基于一个单向函数：K = ( Y<sub>B</sub> )<sup>X<sub>A</sub></sup> mod q = ( Y<sub>A</sub> )<sup>X<sub>B</sub></sup> mod q</li>
<li>Diffie-Hellman算法的有效性建立在<strong>计算离散对数是很困难的</strong>这一基础上。</li>
<li>算法流程：  <strong>P218 具体计算</strong><br><img src="/Cryptography/Diffie-Hellman.png" width="62%"></li>
<li>缺点：不能抵抗所谓的中间人攻击。<br><img src="/Cryptography/中间人攻击.png" width="48%"></li>
</ul>
<h3 id="6-2-RSA算法"><a href="#6-2-RSA算法" class="headerlink" title="6.2 RSA算法"></a>6.2 RSA算法</h3><h5 id="数论"><a href="#数论" class="headerlink" title="数论"></a>数论</h5><ul>
<li>数论的核心问题：<strong>质数</strong></li>
<li><strong>因子分解定律</strong>：任何大于1的整数a都可以被这样分解：a = p<sub>1</sub><sup>a<sub>1</sub></sup> x p<sub>2</sub><sup>a<sub>2</sub></sup> x … x p<sub>k</sub><sup>a<sub>k</sub></sup>，p<sub>1</sub> &gt; p<sub>2</sub> &gt; … &gt; p<sub>k</sub> <ul>
<li>eg. 11011 = 7 x 11<sup>2</sup> x 13</li>
</ul>
</li>
<li><strong>素数有无限多个 </strong></li>
<li><strong>同模</strong>：两个整数如果a mod n = b mod n，则称a与b同模<ul>
<li>eg. 73 mod 23 = 4, 73 = 4 mod 23，则称4与73同模。 </li>
</ul>
</li>
<li>模运算的性质：<ul>
<li>定义：a mod n = b mod n → a ≡ b mod n</li>
<li>交换律：a ≡ b mod n → b ≡ a mod n</li>
<li>传递律：a ≡ b mod n &amp; b ≡ c mod n → a ≡ c mod n</li>
<li>有前提条件的消除律：如果a与n互质，则a x b  ≡ a x c mod n  → b ≡ c mod n </li>
</ul>
</li>
<li><strong>gcd(a, b)</strong>：表示a和b的最大公约数。</li>
<li>a与b互质，则gcd(a, b) = 1</li>
<li><strong>模乘的逆</strong>：<ul>
<li>定义Z<sub>n</sub>为正整数小于n的集合：Z<sub>n</sub> = {0, 1, …, (n-1)}</li>
<li>模乘的逆w<sup>-1</sup> ：对于每个w ∈ Z<sub>p</sub>，ョz，w * z  ≡ 1 mod p ，称z为w<sup>-1</sup></li>
</ul>
</li>
<li><strong>费马定理 / 费马小定理</strong>：<ul>
<li>p是一个质数，a是一个不能被p整除的正整数， 则a<sup>p-1</sup> = 1 mod p</li>
<li>eg. a = 6, p = 7, 6<sup>7-1</sup> ≡ 1 mod 7</li>
<li>另一种形式：p是一个质数，a是一个正整数。则a<sup>p</sup> = a mod p</li>
<li>eg. a = 3, p = 5, 3<sup>5</sup> = 243 ≡ 3 mod 5</li>
</ul>
</li>
<li><strong>欧拉函数</strong><ul>
<li>定义 φ(n) 为小于n且与n互质的正整数。</li>
<li>如果p为一个素数，那么φ(p) = p - 1</li>
<li>如果n = p<sub>1</sub><sup>a<sub>1</sub></sup> p<sub>2</sub><sup>a<sub>2</sub></sup> … p<sub>k</sub><sup>a<sub>k</sub></sup> 是素数分解的n，那么<img src="/Cryptography/oula.png" width="30%"></li>
</ul>
</li>
<li><strong>欧拉定理</strong><ul>
<li>对于任何互质的a和n，a<sup>φ(n)</sup> ≡ 1 mod n，或者 a<sup>φ(n)+1</sup> ≡ a mod n</li>
</ul>
</li>
<li><strong>欧拉定理的推论</strong><ul>
<li>给定两个素数p和q，以及整数n = pq，且0 &lt; m &lt; n</li>
<li>m<sup>φ(n)+1</sup> = m<sup>(p - 1)(q - 1) + 1 </sup> ≡ m mod n</li>
<li>对任意整数k有：[m<sup>φ(n)</sup>]<sup>k</sup> ≡ 1 mod n 或 m<sup>kφ(n)</sup>  ≡ 1 mod n</li>
<li>m<sup>kφ(n)+1</sup> = m<sup>k (p - 1)(q - 1) + 1 </sup> ≡ m mod n</li>
</ul>
</li>
</ul>
<h5 id="RSA算法描述"><a href="#RSA算法描述" class="headerlink" title="RSA算法描述"></a>RSA算法描述</h5><ul>
<li>对于<code>明文分组M</code>和<code>密文分组C</code>，加密和解密过程如下：<ul>
<li>C = M<sup>e</sup> mod n <strong>(加密)</strong></li>
<li>M = C<sup>d</sup> mod n = (M<sup>e</sup>)<sup>d</sup> mod n = M<sup>ed</sup> mod n <strong>(解密)</strong></li>
<li>其中，收发双方均已知n，发送方已知e，且<strong>只有接收方已知d</strong>，因此公钥加密算法的公钥PU = { e, n }，私钥PR = { d, n }</li>
</ul>
</li>
<li>必须满足以下条件：d 和 e 是模 φ(n) 的乘法逆元。即 d 与 φ(n) 互质（因此 e 也与 φ(n) 互质）<ul>
<li><strong>ed = kφ(n)+1</strong></li>
<li>ed ≡ 1 mod φ(n)</li>
<li>d ≡ e<sup>-1</sup> mod φ(n)</li>
<li>gcd( φ(n), d) = 1 ），gcd( φ(n), e) = 1 ）</li>
</ul>
</li>
</ul>
<h5 id="RSA密钥产生"><a href="#RSA密钥产生" class="headerlink" title="RSA密钥产生"></a>RSA密钥产生</h5><ul>
<li>选择(大)质数p, q（私有）</li>
<li>计算 n = p * q</li>
<li>计算 φ(n) = ( p - 1 )( q - 1 )</li>
<li>选择 e：gcd( φ(n), e) = 1 ）1 &lt; e &lt; φ(n)</li>
<li>计算 d ≡ e<sup>-1</sup> mod φ(n)（如何计算d -&gt; 扩展欧基里德算法）</li>
<li>公钥PU = { e, n }，私钥PR = { <strong>d</strong>, n }</li>
</ul>
<h5 id="RSA的安全性"><a href="#RSA的安全性" class="headerlink" title="RSA的安全性"></a>RSA的安全性</h5><ul>
<li>给定n确定p和q是不可行的</li>
<li>给定e和d确定d是不可行的</li>
<li>因子分解问题：对于有大素数因子的数字n，因式分解是个难题。</li>
<li>RSA密钥非常大所以很安全： 1024 / 2048 位</li>
<li>1994年，彼得肖尔表明，量子计算机可以将多项式时间（多项式时间）考虑在内，从而打破了RSA。如果n是300位或更短，则可以在个人计算机上在几个小时内计算出来 截至2008年，通用分解算法考虑的最大（已知）数量是663位长（参见RSA-200），使用最先进的分布式实现。下一个记录可能是768位模数<ul>
<li>RSA 秘密研制于上个世纪60年代初，用于控制战略导弹的发射. 70年代被麻省理工学院等高校的教授独立发明，建立在数论，特别是很难对大素数之积进行因式分解的基础之上。</li>
<li>一旦量子计算机投入实用，将给目前的公共加密技术带来极大威胁。</li>
</ul>
</li>
</ul>
<h5 id="公钥算法与对称加密"><a href="#公钥算法与对称加密" class="headerlink" title="公钥算法与对称加密"></a>公钥算法与对称加密</h5><ul>
<li>从最早开始到现代，虚拟（事实上）所有加密系统都基于替代和排列的基本工具。</li>
<li>公钥算法基于数学函数而不是替换和置换。</li>
<li>公钥密码可用于<ul>
<li>加密/解密</li>
<li>电子签名</li>
<li>密钥交换/管理</li>
</ul>
</li>
<li>应该提到一些关于PKC的常见误解（误解）：<ul>
<li>PKC比对称密钥加密更安全(✕)</li>
<li>PKC是一种通用技术，传统密码已经过时(✕)</li>
<li>使用PKC时，密钥分发没有意义(✕)</li>
</ul>
</li>
</ul>
<h2 id="7-消息认证"><a href="#7-消息认证" class="headerlink" title="7. 消息认证"></a>7. 消息认证</h2><h3 id="7-1-安全服务"><a href="#7-1-安全服务" class="headerlink" title="7.1 安全服务"></a>7.1 安全服务</h3><ul>
<li>对称密钥密码：使用相同的会话密钥K<sub>s</sub>进行/解密。</li>
<li>使用非对称密钥密码（RSA）来传递会话密钥K<sub>s</sub>。</li>
<li>已经被提出的5种信息攻击/安全问题<ul>
<li>泄露</li>
<li>流量分析</li>
<li>冒充</li>
<li>篡改：内容 / 顺序 / 时间 篡改</li>
<li>拒绝服务 / 推诿</li>
</ul>
</li>
<li>解决方法：<ul>
<li>信息保密：泄露，流量分析</li>
<li>数字签名：拒绝服务/推诿</li>
<li>消息认证： 冒充，篡改</li>
</ul>
</li>
</ul>
<h3 id="7-2-消息认证"><a href="#7-2-消息认证" class="headerlink" title="7.2 消息认证"></a>7.2 消息认证</h3><h5 id="消息认证"><a href="#消息认证" class="headerlink" title="消息认证"></a>消息认证</h5><ul>
<li>消息认证：验证所受到的消息确实是来自真正的发送方，且是未被修改的消息，也可以验证消息的顺序和及时性。 <ul>
<li>数字签名是消息认证机制之一。</li>
</ul>
</li>
<li>不同级别的消息认证：消息身份验证的两个基本级别部署机制</li>
<li>基础 - 低级别：身份验证<ul>
<li>消息加密</li>
<li>消息认证码(MAC)</li>
<li>Hash函数</li>
</ul>
</li>
<li>应用 - 高级别：身份认证协议<ul>
<li>PGP ( Pretty Good Privacy)</li>
<li>Kerberos </li>
</ul>
</li>
<li>对于对称加密，提供：<ul>
<li>保密</li>
<li>消息认证(eg. CBC模式)</li>
</ul>
</li>
<li>对于公钥加密，提供：<ul>
<li>消息认证：发送方用自己的私钥给消息加密，它提供了数字签名。</li>
<li>保密：发送方用接收方的公钥给已加密的消息再次加密，提供了保密性。</li>
</ul>
</li>
</ul>
<h5 id="消息认证码"><a href="#消息认证码" class="headerlink" title="消息认证码"></a>消息认证码</h5><ul>
<li>利用密钥来生成一个固定长度的<strong>短数据块</strong>，并将该数据块附加在消息之后。</li>
<li>假设A和B共享一个密钥，当A向B发送消息时：<ul>
<li>A计算MAC，<strong>它是消息和密钥的函数</strong>：MAC = C<sub>K</sub>(M)</li>
<li>消息和MAC一起发送给接收方B</li>
<li>当接收到消息后，B用同样的方式计算出MAC，并与接收到的MAC进行比较：MAC’ = C<sub>K</sub>(M)</li>
<li>如果MAC = MAC’ 则消息得到认证。</li>
</ul>
</li>
<li>MAC函数与加密类似，但是<strong>MAC算法不要求可逆性</strong>，而加密算法必须可逆。</li>
<li>MAC函数不能提供数字签名机制。MAC使用对称加密，既然一方能够验证你的MAC，就能够伪造你的MAC，因为发送方和接收方的秘钥是一样的。</li>
<li><strong>消息摘要与MAC的区别</strong><ul>
<li><strong>消息摘要只能保证消息的完整性</strong>。攻击者可以将原始消息和摘要都篡改成新的消息和摘要。而MAC由于是消息和密钥的函数，攻击者无法生成与篡改后内容匹配的MAC。</li>
<li>MAC不仅能够保证完整性，还能够保证真实性</li>
</ul>
</li>
</ul>
<h5 id="Hash函数-P239"><a href="#Hash函数-P239" class="headerlink" title="Hash函数 P239"></a>Hash函数 P239</h5><ul>
<li>发送者根据待发送的消息使用Hash函数计算一组Hash值，然后将Hash值和消息一起发送过去。</li>
<li>使用Hash函数的原因：<ul>
<li>加密软件速度慢</li>
<li>加密硬件成本不容忽视</li>
<li>加密硬件的优化通常是针对大数据的</li>
<li>加密算法可能受专利保护</li>
<li>加密算法受美国出口管制</li>
</ul>
</li>
<li>哈希函数的要求 <strong>P245</strong><ol>
<li>H（x）可以应用于任何大小的数据块x</li>
<li>H（x）产生固定长度的输出</li>
<li>3.对于任何给定的x，H（x）相对容易计算，使得硬件和软件实现都是现实的。</li>
<li>单向性：对于任何给定的代码h，它是计算上的不可能找到x使得H（x）= h。</li>
<li>弱碰撞阻力：对于任何给定的x，找到y≠x -&gt; H(y) = H(x)在计算上是不可行的。</li>
<li>6.强抗碰撞性：找到任何（x，y）使得H（x）= H（y）在计算上是不可行的。</li>
</ol>
</li>
<li>两个简单的Hash函数：<ul>
<li>最简单的Hash函数是每个块的逐位异或：C<sub>i</sub> = b<sub>i1</sub> ⊕ b<sub>i2</sub> ⊕ …  ⊕ b<sub>im</sub></li>
<li>Hash算法包括重复地使用一个压缩函数f：输入为链接变量(上一步的n位输入)和一个b位的块，产生一个n位的输出。<strong>P248</strong></li>
</ul>
</li>
<li>Hash函数的应用<ul>
<li>消息摘要</li>
<li>密码/口令保护</li>
<li>防止重放攻击：用户和Auth Sever秘密共享一个seed，Hash<sup>N-x(seed)，N是一个很大的初始值，x是登录验证的次数。(<strong><code>重放攻击</code></strong>是指攻击者发送一个目的主机已接收过的包，来达到欺骗系统的目的，<strong>主要用于身份认证过程</strong>，破坏认证的正确性。)</sup></li>
</ul>
</li>
</ul>
<h5 id="安全Hash算法-SHA"><a href="#安全Hash算法-SHA" class="headerlink" title="安全Hash算法 SHA"></a>安全Hash算法 SHA</h5><ul>
<li>SHA-1 来自 MD4</li>
<li>SHA-2 family：SHA-224, SHA-256, SHA-384和SHA-512<br><img src="/Cryptography/SHA512.png" width="60%"></li>
</ul>
<h5 id="消息摘要"><a href="#消息摘要" class="headerlink" title="消息摘要"></a>消息摘要</h5><ul>
<li>MD5消息摘要算法<ul>
<li>MD5消息摘要算法由1990年麻省理工学院的Ron Rivest创建</li>
<li>它将任意长度的消息(但会分成512bits一组)作为输入并产生<strong>128位消息摘要</strong>作为输出。</li>
</ul>
</li>
</ul>
<h2 id="8-数字签名"><a href="#8-数字签名" class="headerlink" title="8. 数字签名"></a>8. 数字签名</h2><h3 id="8-1-数字签名简介"><a href="#8-1-数字签名简介" class="headerlink" title="8.1 数字签名简介"></a>8.1 数字签名简介</h3><h5 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h5><ul>
<li>数字签名或数字签名方案是用于证明数字消息或文档的真实性的数学方案。</li>
<li>有效的数字签名使接收方有理由相信该消息是由已知接收方创建的，并且该邮件在传输过程中未被更改。</li>
<li>数字签名通常用于软件分发，金融交易，以及其他情况需要检测修改的情况。</li>
</ul>
<h5 id="数字签名的特征"><a href="#数字签名的特征" class="headerlink" title="数字签名的特征"></a>数字签名的特征</h5><ul>
<li>能验证签名者、签名日期和时间</li>
<li>能认证被签的消息内容</li>
<li>签名应能由第三方仲裁，以解决争执</li>
</ul>
<h5 id="数字签名需求"><a href="#数字签名需求" class="headerlink" title="数字签名需求"></a>数字签名需求</h5><ul>
<li>签名必须是与消息相关的二进制串</li>
<li>签名必须使用发送方某些独有的信息，以防伪造和否认</li>
<li>产生、识别和验证数字签名比较容易</li>
<li>伪造数字签名在计算上是不可行的</li>
<li>保存数字签名副本是可行的</li>
</ul>
<p><img src="/Cryptography/数字签名.png" width="55%"></p>
<h5 id="数字签名过程-P300"><a href="#数字签名过程-P300" class="headerlink" title="数字签名过程 P300"></a>数字签名过程 P300</h5><ul>
<li>数字签名需要<strong>公钥系统</strong>。</li>
<li>签名者用他的私钥签名，验证者使用签名者的公钥进行验证。<br><img src="/Cryptography/数字签名1.png" width="55%"><br><img src="/Cryptography/数字签名2.png" width="55%"></li>
</ul>
<h5 id="数字签名提供的安全服务"><a href="#数字签名提供的安全服务" class="headerlink" title="数字签名提供的安全服务"></a>数字签名提供的安全服务</h5><ul>
<li>消息验证</li>
<li>消息完整性</li>
<li>防止抵赖</li>
<li>消息完整性</li>
</ul>
<h3 id="8-2-数字签名方案"><a href="#8-2-数字签名方案" class="headerlink" title="8.2 数字签名方案"></a>8.2 数字签名方案</h3><h5 id="RSA数字签名方案-P305"><a href="#RSA数字签名方案-P305" class="headerlink" title="RSA数字签名方案 P305"></a>RSA数字签名方案 P305</h5><p><img src="/Cryptography/RSA.png" width="50%"><br><img src="/Cryptography/DSA.png" width="50%"></p>
<h3 id="8-3-用户认证协议-P348"><a href="#8-3-用户认证协议-P348" class="headerlink" title="8.3 用户认证协议 P348"></a>8.3 用户认证协议 P348</h3><h5 id="Kerberos"><a href="#Kerberos" class="headerlink" title="Kerberos"></a>Kerberos</h5><ul>
<li>Kerberos概述：<ul>
<li>Kerberos是一种计算机网络认证协议，它允许通过非安全网络进行通信的节点以安全的方式相互证明其身份。</li>
<li>它也是麻省理工学院出版的一套免费软件，它实现了这个协议。</li>
<li>麻省理工学院开发了Kerberos来保护Project Athena提供的网络服务</li>
<li>存在多种版本的协议; 版本1-3仅在麻省理工学院内部发生。</li>
<li>版本4发表于20世纪80年代后期</li>
<li>版本5在1993年作为RFC 1510出现<br><img src="/Cryptography/Ker.png" width="70%"></li>
</ul>
</li>
<li>一个全方位服务的Kerberos环境包括：<ul>
<li>1个Kerberos服务器</li>
<li>多个客户端</li>
<li>多个应用服务器</li>
</ul>
</li>
<li>Kerberos环境要求：<ul>
<li>Kerberos服务器必须具有该用户ID和密码</li>
<li>Kerberos服务器必须与每一个服务器共享密钥  </li>
</ul>
</li>
</ul>
<blockquote>
<p>这种环境被称为领域</p>
</blockquote>
<h5 id="X-509"><a href="#X-509" class="headerlink" title="X.509"></a>X.509</h5><ul>
<li>X.509是用于单点登录（SSO）和权益管理基础设施（PMI）的公钥基础设施（PKI）的ITU-T（国际电信联盟）标准。</li>
<li>X.509除其他外指定了公钥证书，证书撤回列表，属性证书和证书路径确认算法的标准格式。<br>有关X.509的详细信息，请参阅第14.2节或维基百科</li>
</ul>
<h3 id="8-4-PGP-P445"><a href="#8-4-PGP-P445" class="headerlink" title="8.4 PGP P445"></a>8.4 PGP P445</h3><h5 id="PGP概述"><a href="#PGP概述" class="headerlink" title="PGP概述"></a>PGP概述</h5><ul>
<li>Pretty Good Privacy（PGP）是一种提供加密隐私和身份验证的计算机程序。</li>
<li>PGP通常用于签名，加密和解密电子邮件，以提高电子邮件通信的安全性。<br>它由Philip Zimmermann于1991年创建。<br>PGP和其他类似产品遵循OpenPGP标准（RFC 4880）来加密和解密数据。  </li>
<li>PGP-用户认证：<strong>P448</strong><br><img src="/Cryptography/PGP.png" width="50%"></li>
<li>PGP-保密：<br><img src="/Cryptography/PGP2.png" width="50%"></li>
<li>PGP-保密且认证<br><img src="/Cryptography/PGP3.png" width="60%"> </li>
</ul>
<h2 id="9-网络安全"><a href="#9-网络安全" class="headerlink" title="9. 网络安全"></a>9. 网络安全</h2><h3 id="9-1-网络安全概述-P396"><a href="#9-1-网络安全概述-P396" class="headerlink" title="9.1 网络安全概述 P396"></a>9.1 网络安全概述 P396</h3><ul>
<li>Web现在被广泛使用：政府、企业、个人，但互联网和Web容易受到攻击</li>
<li>TCP/IP 上的HTTP需要增加安全机制。</li>
<li>有各种各样的威胁：<ul>
<li>完整性</li>
<li>保密性</li>
<li>拒绝服务</li>
<li>认证 </li>
</ul>
</li>
<li>在哪里添加安全机制？<br><img src="/Cryptography/网络安全.png" width="40%"> </li>
</ul>
<h3 id="9-2-SSL-TLS"><a href="#9-2-SSL-TLS" class="headerlink" title="9.2 SSL / TLS"></a>9.2 SSL / TLS</h3><h5 id="SSL-TLS-P-397"><a href="#SSL-TLS-P-397" class="headerlink" title="SSL / TLS P 397"></a>SSL / TLS P 397</h5><ul>
<li>SSL：安全套接字层<ul>
<li>版本：1-3</li>
<li>最初由Netscape开发</li>
<li>使用TCP提供可靠和安全的端到端服务</li>
<li>SSL位于<strong>应用层和传输层之下</strong></li>
<li>SSL有两层四个协议</li>
</ul>
</li>
<li>TLS：传输层安全协议<ul>
<li>版本：1.1-1.2</li>
<li>TLS是SSL的继承者</li>
<li>成为互联网标准（RFC 2246）</li>
</ul>
</li>
</ul>
<h5 id="SSL-TLS提供服务："><a href="#SSL-TLS提供服务：" class="headerlink" title="SSL / TLS提供服务："></a>SSL / TLS提供服务：</h5><ul>
<li>Fragmentation(碎片?分段?)</li>
<li>压缩</li>
<li>消息完整性：MAC/HMA, 数字签名(公钥加密)</li>
<li>保密性：密钥交换(公钥加密)，对称密钥加密</li>
<li>Framing(取景? 框架？)</li>
</ul>
<h5 id="SSL-TLS-安全机制"><a href="#SSL-TLS-安全机制" class="headerlink" title="SSL/TLS 安全机制"></a>SSL/TLS 安全机制</h5><ul>
<li><p>密钥交换算法  - 保密性<br><img src="/Cryptography/Keyex.png" width="55%"> </p>
<ul>
<li>RSA<br><img src="/Cryptography/key1.png" width="55%"> </li>
<li>Anonymous(匿名的) Diffie-Hellman<br><img src="/Cryptography/key2.png" width="55%"> </li>
<li>Ephemeral(短暂的) Diffie-Hellman<br><img src="/Cryptography/key3.png" width="55%"></li>
</ul>
</li>
<li><p>对称加密/解密算法 - 保密性<br><img src="/Cryptography/ssl1.png" width="60%"></p>
</li>
<li>Hash函数 - 消息完整性<br><img src="/Cryptography/ssl2.png" width="55%"></li>
</ul>
<h5 id="SSL-TLS-结构"><a href="#SSL-TLS-结构" class="headerlink" title="SSL/TLS 结构"></a>SSL/TLS 结构</h5><ul>
<li>2层</li>
<li>4 个协议<br><img src="/Cryptography/sll3.png" width="40%"></li>
<li><strong>SSL / TLS 记录协议</strong>(Record Protocol)<ul>
<li>提供的安全服务：保密性，完整性</li>
<li>如何利用HMAC算法和会话密钥同意：握手 </li>
<li><img src="/Cryptography/sslrecord.png" width="55%"></li>
</ul>
</li>
<li><strong>SSL / TLS 握手协议</strong><ul>
<li>允许服务器和客户端：1. 相互认证 2. 协商加密和MAC算法 3. 协商要使用的加密密钥 </li>
<li>包括一系列分阶段的消息： 建立安全功能  -&gt; 服务器验证和密钥交换 -&gt; 客户端验证和密钥交换 -&gt; 结束<br><img src="/Cryptography/hs.png" width="50%"> <img src="/Cryptography/hs12.png" width="35%"><br><img src="/Cryptography/hs1.png" width="50%">  <img src="/Cryptography/hs13.png" width="40%">  <img src="/Cryptography/hs2.png" width="50%"><img src="/Cryptography/hs22.png" width="50%"><br><img src="/Cryptography/hs3.png" width="50%">  <img src="/Cryptography/hs32.png" width="50%"></li>
</ul>
</li>
</ul>
<h3 id="9-3-Wireshark-实验-TLS1-2"><a href="#9-3-Wireshark-实验-TLS1-2" class="headerlink" title="9.3 Wireshark 实验 - TLS1.2"></a>9.3 Wireshark 实验 - TLS1.2</h3><ul>
<li>POP3 and SMTP <strong>over TCP</strong><br><img src="/Cryptography/tcp1.png" width="30%"><img src="/Cryptography/tcp2.png" width="30%"></li>
<li>POP3 and SMTP <strong>over TLS</strong><br><img src="/Cryptography/pop31.png" width="30%"><img src="/Cryptography/pop32.png" width="30%"></li>
<li>Mail Agent(邮件代理): Foxmail 7.x</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Dai Sine</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://daisine.me/Cryptography/">http://daisine.me/Cryptography/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/note/">note</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/uml/"><i class="fa fa-chevron-left">  </i><span>UML</span></a></div><div class="next-post pull-right"><a href="/web/"><span>Web开发笔记</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="disqus_thread"></div><script>var unused = null;
var disqus_config = function () {
  this.page.url = 'http://daisine.me/Cryptography/';
  this.page.identifier = 'Cryptography/';
  this.page.title = '密码学笔记';
}
var d = document, s = d.createElement('script');
s.src = "https://" + 'dasine' +".disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2019/05/10/5cd525fea97ac.png)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2019 By Dai Sine</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script src="/js/search/algolia.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>